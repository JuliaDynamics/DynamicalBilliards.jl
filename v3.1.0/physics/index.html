



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="An easy-to-use, modular and extendable Julia package for Dynamical Billiard systems in two dimensions.">
      
      
      
        <meta name="author" content="George Datseris">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.9.4">
    
    
      
        <title>Physics - DynamicalBilliards.jl</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#7e57c2">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../assets\Documenter.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-purple" data-md-color-accent="cyan">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#pinned-particles" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="DynamicalBilliards.jl" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                DynamicalBilliards.jl
              </span>
              <span class="md-header-nav__topic">
                Physics
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/JuliaDynamics/DynamicalBilliards.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="DynamicalBilliards.jl" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    DynamicalBilliards.jl
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/JuliaDynamics/DynamicalBilliards.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../basic/high_level/" title="High Level API" class="md-nav__link">
      High Level API
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../visualizing/" title="Visualizing" class="md-nav__link">
      Visualizing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../basic/phasespaces/" title="Phase Spaces" class="md-nav__link">
      Phase Spaces
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../ray-splitting/" title="Ray-Splitting" class="md-nav__link">
      Ray-Splitting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../lyapunovs/" title="Lyapunov Exponents" class="md-nav__link">
      Lyapunov Exponents
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../mushroomtools/" title="MushroomTools" class="md-nav__link">
      MushroomTools
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Physics
      </label>
    
    <a href="./" title="Physics" class="md-nav__link md-nav__link--active">
      Physics
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pinned-particles" title="Pinned Particles" class="md-nav__link">
    Pinned Particles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#velocity-measure" title="Velocity measure" class="md-nav__link">
    Velocity measure
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../basic/low_level/" title="Internals" class="md-nav__link">
      Internals
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorials/billiard_table/" title="Defining a Billiard" class="md-nav__link">
      Defining a Billiard
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorials/own_obstacle/" title="Creating your own Obstacle" class="md-nav__link">
      Creating your own Obstacle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorials/examples/" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pinned-particles" title="Pinned Particles" class="md-nav__link">
    Pinned Particles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#velocity-measure" title="Velocity measure" class="md-nav__link">
    Velocity measure
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/JuliaDynamics/DynamicalBilliards.jl/edit/master/docs/physics.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Physics</h1>
                
                <p>This page briefly discusses physical aspects of billiard systems.</p>
<p><a id='Pinned-Particles-1'></a></p>
<h2 id="pinned-particles">Pinned Particles</h2>
<p>In the case of propagation with magnetic field, a particle may be "pinned" (collision-less): There are no possible collisions that take place and the particle will revolve in circles forever. This can happen for specific initial conditions depending on your billiard table and the angular velocity ω. The function <a href="./#DynamicalBilliards.ispinned"><code>ispinned</code></a> shows you whether a particle meets the conditions.</p>
<p><a id='DynamicalBilliards.ispinned' href='#DynamicalBilliards.ispinned'>#</a>
<strong><code>DynamicalBilliards.ispinned</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span>ispinned(p::MagneticParticle, bd::Billiard)
</pre></div>


<p>Return <code>true</code> if the particle is pinned with respect to the billiard. Pinned particles either have no valid collisions (go in circles forever) or all their valid collisions are with periodic walls, which again means that they go in cirles for ever.</p>
<p><a target='_blank' href='https://github.com/JuliaDynamics/DynamicalBilliards.jl/blob/67c0ffe6ac1693697786d4f2cf807c857c48c774/src/timeevolution/propagation.jl#L162-L168' class='documenter-source'>source</a><br></p>
<hr />
<p>In such event, the convention followed by <code>DynamicalBilliards</code> is the following: <a href="../basic/high_level/#DynamicalBilliards.evolve!"><code>evolve!</code></a> returns the expected output, however all returned vectors have only 2 entries. The collision times always have the entries <code>0.0, Inf</code>. All other returned vectors have the initial conditions, repeated once.</p>
<p><a href="../basic/high_level/#DynamicalBilliards.evolve!"><code>evolve!</code></a> can be given an additional <code>warning</code> keyword argument in the case of magnetic propagation, e.g. <code>warning = true</code> that throws a  message whenever a pinned particle is evolved.</p>
<hr />
<p><a id='Velocity-measure-1'></a></p>
<h2 id="velocity-measure">Velocity measure</h2>
<p>Both <code>Particle</code> and <code>MagneticParticle</code> are assumed to <strong>always</strong> have a velocity vector of measure 1 during evolution. This simplifies the formulas used internally to a significant amount.</p>
<p>However, during ray-splitting, the a <code>MagneticParticle</code> may be in areas with different angular velocities (result of the <a href="../tutorials/ray-splitting/#ray-splitting-functions">ω_new</a> function). Physically, in such a situation, the velocity measure of the particle could also change. This change depends on the forces acting on the particle (e.g. magnetic field) as well as the relation of the momentum with the velocity (functional type of kinetic energy).</p>
<p>In any case, such a change is not accounted for internally by <code>DynamicalBilliards</code>. However it is very easy to implement this by "re-normalizing" the angular velocities you use. Since the "code" velocity has measure one, the rotation radius is given by</p>
<div>
<div class="MathJax_Preview">
r = \frac{1}{\omega_\text{code}} = \frac{v_\text{real}}{\omega_\text{real}}
</div>
<script type="math/tex; mode=display">
r = \frac{1}{\omega_\text{code}} = \frac{v_\text{real}}{\omega_\text{real}}
</script>
</div>
<p>then one simply has to adjust the values of <code>ω</code> given in the code with</p>
<div>
<div class="MathJax_Preview">
\omega_\text{code} = \frac{\omega_\text{real}}{v_\text{real}}
</div>
<script type="math/tex; mode=display">
\omega_\text{code} = \frac{\omega_\text{real}}{v_\text{real}}
</script>
</div>
<p>After getting the timeseries:</p>
<div class="codehilite"><pre><span></span><span class="c"># These are the &quot;code&quot;-data. |v| = 1 always</span>
<span class="n">ct</span><span class="p">,</span> <span class="n">poss</span><span class="p">,</span> <span class="n">vels</span><span class="p">,</span> <span class="n">omegas</span> <span class="o">=</span> <span class="n">evolve</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">bd</span><span class="p">,</span> <span class="n">ttotal</span><span class="p">)</span>
<span class="n">xt</span><span class="p">,</span> <span class="n">yt</span><span class="p">,</span> <span class="n">vxt</span><span class="p">,</span> <span class="n">vyt</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">timeseries</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">bd</span><span class="p">,</span> <span class="n">ttotal</span><span class="p">)</span>
</pre></div>


<p>you only need to make some final adjustment on the <code>vxt, vyt</code>. The position and time data are completely unaffected.</p>
<div class="codehilite"><pre><span></span><span class="n">omegas_code</span> <span class="o">=</span> <span class="n">omegas</span>
<span class="c"># real angular velocities:</span>
<span class="n">omegas_real</span> <span class="o">=</span> <span class="n">supplied_by_user</span>
<span class="c"># or with some user provided function:</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">o</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">o</span> <span class="o">==</span> <span class="mf">0.5</span> <span class="o">?</span> <span class="mi">2</span><span class="n">o</span> <span class="o">:</span> <span class="n">o</span><span class="o">*√</span><span class="mi">2</span><span class="p">)</span>
<span class="n">omegas_real</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="p">(</span><span class="n">omegas_code</span><span class="p">)</span>
<span class="c"># real velocity measure:</span>
<span class="n">vels_real</span> <span class="o">=</span> <span class="n">abs</span><span class="o">.</span><span class="p">(</span><span class="n">omegas_real</span> <span class="o">./</span> <span class="n">omegas_code</span><span class="p">)</span>

<span class="n">contt</span> <span class="o">=</span> <span class="n">cumsum</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
<span class="n">omega_t</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">vxtreal</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">vxt</span><span class="p">)</span>
<span class="n">vytreal</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">vyt</span><span class="p">)</span>
<span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span> <span class="kp">in</span> <span class="n">eachindex</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
  <span class="n">vxtreal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="n">vels_real</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
  <span class="n">vytreal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="n">vels_real</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
  <span class="n">omega_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">omegas_real</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

  <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span>  <span class="n">contt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>


<p>Now you can be sure that the particle at time <code>t[i]</code> had real velocity <code>[vxtreal[i], vytreal[i]]</code> and was propagating with real angular velocity <code>omega_t[i]</code>.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../mushroomtools/" title="MushroomTools" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                MushroomTools
              </span>
            </div>
          </a>
        
        
          <a href="../basic/low_level/" title="Internals" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Internals
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/JuliaDynamics/DynamicalBilliards.jl" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.30f6b8b1.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:".."}})</script>
      
        <script src="../assets\mathjaxhelper.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
    
  </body>
</html>